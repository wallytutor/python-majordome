## Solution algorithm


Using a segregated solution of non-linear boundaries or immersed nodes:

$$
\begin{bmatrix}
A_{(0)} & A_{E}  & 0      &        &        & \dots  & 0      & 0       \\[6pt]
A_{W}   & A_{P}  & A_{E}  &        &        & \dots  & 0      & 0       \\[6pt]
0       & A_{W}  & A_{P}  & A_{E}  & 0      & \dots  & 0      & 0       \\[6pt]
0       & 0      & \ddots & \ddots & \ddots & \ddots & \vdots & \vdots  \\[6pt]
\vdots  & \vdots & \ddots & \ddots & \ddots & \ddots & 0      & 0       \\[6pt]
0       & 0      & \dots  & 0      & A_{W}  & A_{P}  & A_{E}  & 0       \\[6pt]
0       & 0      & \dots  & 0      & 0      & A_{W}  & A_{P}  & A_{E}   \\[6pt]
0       & 0      & \dots  & 0      & 0      & 0      & A_{W}  & A_{(n)} \\[6pt]
\end{bmatrix}\cdotp
%--------------------------------------
\begin{bmatrix}
c_{(0)}^{\tau}   \\[6pt]
c_{(1)}^{\tau}   \\[6pt]
c_{(2)}^{\tau}   \\[6pt]
c_{(3)}^{\tau}   \\[6pt]
\vdots           \\[6pt]
c_{(N-3)}^{\tau} \\[6pt]
c_{(N-2)}^{\tau} \\[6pt]
c_{(N-1)}^{\tau} \\[6pt]
\end{bmatrix}=
%--------------------------------------
\begin{bmatrix}
c_{(0)}^{0}   \\[6pt]
c_{(1)}^{0}   \\[6pt]
c_{(2)}^{0}   \\[6pt]
c_{(3)}^{0}   \\[6pt]
\vdots           \\[6pt]
c_{(N-3)}^{0} \\[6pt]
c_{(N-2)}^{0} \\[6pt]
c_{(N-1)}^{0} \\[6pt]
\end{bmatrix}+
%--------------------------------------
\begin{bmatrix}
B_{(0)}   \\[6pt]
0         \\[6pt]
0         \\[6pt]
0         \\[6pt]
\vdots    \\[6pt]
0         \\[6pt]
0         \\[6pt]
B_{(N-1)} \\[6pt]
\end{bmatrix}
$$


Integrating boundaries as an extended problem:

$$
\begin{bmatrix}
B_{1}   & B_{2}  & 0      &        &        & \dots  & 0      & 0       \\[6pt]
A_{W}   & A_{P}  & A_{E}  &        &        & \dots  & 0      & 0       \\[6pt]
0       & A_{W}  & A_{P}  & A_{E}  & 0      & \dots  & 0      & 0       \\[6pt]
0       & 0      & \ddots & \ddots & \ddots & \ddots & \vdots & \vdots  \\[6pt]
\vdots  & \vdots & \ddots & \ddots & \ddots & \ddots & 0      & 0       \\[6pt]
0       & 0      & \dots  & 0      & A_{W}  & A_{P}  & A_{E}  & 0       \\[6pt]
0       & 0      & \dots  & 0      & 0      & A_{W}  & A_{P}  & A_{E}   \\[6pt]
0       & 0      & \dots  & 0      & 0      & 0      & C_{2}  & C_{1} \\[6pt]
\end{bmatrix}\cdotp
%--------------------------------------
\begin{bmatrix}
c_{(G)}^{\tau}   \\[6pt]
c_{(0)}^{\tau}   \\[6pt]
c_{(1)}^{\tau}   \\[6pt]
c_{(2)}^{\tau}   \\[6pt]
\vdots           \\[6pt]
c_{(N-2)}^{\tau} \\[6pt]
c_{(N-1)}^{\tau} \\[6pt]
c_{(G)}^{\tau} \\[6pt]
\end{bmatrix}=
%--------------------------------------
\begin{bmatrix}
B_{(0)}^{0}   \\[6pt]
c_{(0)}^{0}   \\[6pt]
c_{(1)}^{0}   \\[6pt]
c_{(2)}^{0}   \\[6pt]
\vdots           \\[6pt]
c_{(N-2)}^{0} \\[6pt]
c_{(N-1)}^{0} \\[6pt]
B_{(n)}^{0} \\[6pt]
\end{bmatrix}
$$
